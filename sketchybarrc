#!/usr/bin/env lua

-- Ensure we can resolve modules when launched by launchd (cwd may not be CONFIG_DIR)
local HOME = os.getenv("HOME")
local CONFIG_DIR = os.getenv("BARISTA_CONFIG_DIR") or (HOME .. "/.config/sketchybar")
local lua_cpath = os.getenv("SKETCHYBAR_LUA_CPATH") or (HOME .. "/.local/share/sketchybar_lua/?.so")

package.cpath = package.cpath .. ";" .. lua_cpath
package.path = table.concat({
  package.path,
  CONFIG_DIR .. "/?.lua",
  CONFIG_DIR .. "/helpers/lib/?.lua",
}, ";")

package.loaded["main"] = nil
require("main")

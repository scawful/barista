PLUGIN_DIR="$CONFIG_DIR/plugins"

##### Bar Appearance #####
# https://felixkratz.github.io/SketchyBar/config/bar

export ROSEWATER=0xFFf5e0dc #f5e0dc
export FLAMINGO=0xFFf2cdcd #f2cdcd
export PINK=0xFFf5c2e7 #f5c2e7
export MAUVE=0xFFcba6f7 #cba6f7
export RED=0xFFf38ba8 #f38ba8
export MAROON=0xFFeba0ac #eba0ac
export PEACH=0xFFfab387 #fab387
export YELLOW=0xFFf9e2af #f9e2af
export GREEN=0xFFa6e3a1 #a6e3a1
export TEAL=0xFF94e2d5 #94e2d5
export SKY=0xFF89dceb #89dceb
export SAPPHIRE=0xFF74c7ec #74c7ec
export BLUE=0xFF89b4fa #89b4fa
export LAVENDER=0xFFb4befe #b4befe

export WHITE=0xFFcdd6f4 #cdd6f4 
export DARK_WHITE=0xFF9399b2  #9399b2

export BG_PRI_COLR=0xEE1e1e2e #1e1e2e
export BG_SEC_COLR=0xFF313244 #313244

sketchybar --bar position=top height=25 blur_radius=30 color=0xD04C3B52 \
                 margin=5 padding_left=5 padding_right=5 corner_radius=7 y_offset=5 \
                 display=all

# 0x40000000

##### Changing Defaults #####
# We now change some default values, which are applied to all further items.
# For a full list of all available item properties see:
# https://felixkratz.github.io/SketchyBar/config/items

default=(
  padding_left=5
  padding_right=5
  icon.font="Hack Nerd Font:Bold:16.0"
  label.font="Hack Nerd Font:Bold:14.0"
  icon.color=0xffffffff
  label.color=0xffffffff
  icon.padding_left=4
  icon.padding_right=4
  label.padding_left=4
  label.padding_right=4
)
sketchybar --default "${default[@]}"

##### Adding Mission Control Space Indicators #####
# Let's add some mission control spaces:
# https://felixkratz.github.io/SketchyBar/config/components#space----associate-mission-control-spaces-with-an-item
# to indicate active and available mission control spaces.

# 󰷠

sketchybar    --add item zelda left                                               \
              --set zelda icon=󰀵                                                  \
                    icon.font="SF Pro:Black:16.0"                                 \
                    label.drawing=off                                             \
                    click_script="sketchybar -m --set \$NAME popup.drawing=toggle" \
                    popup.background.border_width=2                               \
                    popup.background.corner_radius=3                              \
                    popup.background.border_color=0xffffffff                      \
                    popup.background.color=0xD04C3B52                             \
                                                                                  \
                                                                                  \
              --add item yaze popup.zelda                                         \
              --set yaze icon=󰯙                                                   \
                               label="Yaze"                                       \
                               click_script="open -a ~/Code/yaze/build/bin/yaze.app/Contents/MacOS/yaze;                                            \
                                             sketchybar -m --set zelda popup.drawing=off"     \
              --add item mesen popup.zelda \
              --set mesen icon=󰺷  \
                          label="Mesen" \
                          click_script="open -a mesen;
                                        sketchybar -m --set zelda popup.drawing=off" \
              --add item apple.activity popup.zelda                                      \
              --set apple.activity icon=󰨇                                                     \
                               label="Activity"                                               \
                               click_script="open -a 'Activity Monitor';                       
                                             sketchybar -m --set zelda popup.drawing=off" \
              --add item apple.preferences popup.zelda                                   \
              --set apple.preferences icon=                                                  \
                               label="Preferences"                                            \
                               click_script="open -a 'System Preferences';                    
                                             sketchybar -m --set zelda popup.drawing=off"

              # --add item apple.lock popup.zelda                                          \
              # --set apple.lock icon=􀒳                                                         \
              #                  label="Lock Screen"                                            \
              #                  click_script="pmset displaysleepnow;                           
              #                                sketchybar -m --set zelda popup.drawing=off"


SPACE_ICONS=("" "1" "2" "3" "4" "5" "6" "7" "8" "9" "10")
for i in "${!SPACE_ICONS[@]}"
do
  sid="$(($i+1))"
  space=(
    space="$sid"
    icon="${SPACE_ICONS[i]}"
    icon.padding_left=7
    icon.padding_right=7
    background.color=0x20ffffff
    background.corner_radius=7
    background.height=18
    label.drawing=off
    script="$PLUGIN_DIR/space.sh"
    click_script="yabai -m space --focus $sid"
  )
  sketchybar --add space space."$sid" left --set space."$sid" "${space[@]}" \
            #  --set space."$sid" icon.drawing=on script="$PLUGIN_DIR/icons.sh" \
            #  --subscribe space."$sid" space_change
done

sketchybar --add bracket spaces '/space\..*/'               \
           --set         spaces background.color=0x40000000 \
                                background.corner_radius=7  \
                                background.height=20

##### Adding Left Items #####
# We add some regular items to the left side of the bar, where
# only the properties deviating from the current defaults need to be set

sketchybar --add item front_app left \
           --set front_app icon.drawing=on script="$PLUGIN_DIR/front_app.sh" \
           --subscribe front_app front_app_switched

##### Adding Right Items #####
# https://felixkratz.github.io/SketchyBar/config/items#adding-items-to-sketchybar
# https://felixkratz.github.io/SketchyBar/config/events

sketchybar --add item clock right \
           --set clock update_freq=10 icon=  script="$PLUGIN_DIR/clock.sh" \
           --add item volume right \
           --set volume script="$PLUGIN_DIR/volume.sh" \
           --subscribe volume volume_change \
           --add item battery right \
           --set battery update_freq=120 script="$PLUGIN_DIR/battery.sh" \
           --subscribe battery system_woke power_source_change \
          #  --add alias "Control Center,WiFi" right

sketchybar --set clock background.color=0x80111111 \
                     background.corner_radius=7  \
                     background.height=20

sketchybar --set volume background.color=0x8020B2AA \
                     background.corner_radius=7  \
                     background.height=20

sketchybar --set battery background.color=$GREEN \
                       background.corner_radius=7  \
                       background.height=20


##### Force all scripts to run the first time (never do this in a script) #####
sketchybar --update
